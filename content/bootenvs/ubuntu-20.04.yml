---
Name: "ubuntu-20.04-install"
Description: "Ubuntu-20.04 install"
Documentation: |
  Installs Ubuntu Focal Fossa (20.04) LTS version.  This BootEnv will install
  the General Available (GA) kernel.

  Both amd64 and arm64 architectures are supported.

  NOTE - Default Ubuntu ISOs will attempt to check internet repositories, this
  can cause problems during provisioning if your environment does not have
  outbound access.  Workaround this by defining Options 3 (Gateway) and 6 (DNS)
  for your Subnet settings.
Meta:
  color: "purple"
  feature-flags: "change-stage-v2"
  icon: "linux"
  title: "Digital Rebar Community Content"
OS:
  Name: "ubuntu-20.04"
  Family: "ubuntu"
  Codename: "Focal Fossa"
  Version: "20.04"
  SupportedArchitectures:
    amd64:
      IsoFile: "ubuntu-20.04-live-server-amd64.iso"
      IsoUrl: "https://releases.ubuntu.com/20.04/ubuntu-20.04-live-server-amd64.iso"
      IsoSha256: "caf3fd69c77c439f162e2ba6040e9c320c4ff0d69aad1340a514319a9264df9f"
      Kernel: "casper/vmlinuz"
      Initrds:
        - "casper/initrd"
      BootParams: >-
        root=/dev/ram0
        ramdisk_size=1500000
        ip=dhcp
        url={{.ProvisionerURL}}/isos/ubuntu-20.04-live-server-amd64.iso
        autoinstall
        ds=nocloud-net;s={{.Machine.Url}}/
        {{.Param "kernel-options"}}
        --
        {{.Param "kernel-console"}}
    arm64:
      IsoFile: "ubuntu-20.04-live-server-arm64.iso"
      IsoUrl: "http://cdimage.ubuntu.com/ubuntu/releases/20.04/release/ubuntu-20.04-live-server-arm64.iso"
      IsoSha256: "46d5ee0843e5da7e170fa84b5f4e9e474456180659221ec6cc2dc60f6fcd1b06"
      Kernel: "casper/vmlinuz"
      Loader: "grubarm64.efi"
      Initrds:
        - "casper/initrd"
      BootParams: >-
        root=/dev/ram0
        ramdisk_size=1500000
        ip=dhcp
        url={{.ProvisionerURL}}/isos/ubuntu-20.04-live-server-arm64.iso
        autoinstall
        ds=nocloud-net;s={{.Machine.Url}}/
        {{.Param "kernel-options"}}
        --
        {{.Param "kernel-console"}}
OnlyUnknown: false
OptionalParams:
  - part-scheme
  - operating-system-disk
  - provisioner-default-user
  - provisioner-default-fullname
  - provisioner-default-uid
  - provisioner-default-password-hash
  - kernel-console
  - kernel-options
  - proxy-servers
  - dns-domain
  - local-repo
  - proxy-servers
  - ntp-servers
  - select-kickseed
ReadOnly: true
RequiredParams: []
Templates:
  - ID: "kexec.tmpl"
    Name: "kexec"
    Path: "{{.Machine.Path}}/kexec"
  - ID: "default-pxelinux.tmpl"
    Name: "pxelinux"
    Path: "pxelinux.cfg/{{.Machine.HexAddress}}"
  - ID: "default-ipxe.tmpl"
    Name: "ipxe"
    Path: "{{.Machine.Address}}.ipxe"
  - ID: "default-pxelinux.tmpl"
    Name: "pxelinux-mac"
    Path: 'pxelinux.cfg/{{.Machine.MacAddr "pxelinux"}}'
  - ID: "default-ipxe.tmpl"
    Name: "ipxe-mac"
    Path: '{{.Machine.MacAddr "ipxe"}}.ipxe'
  - ID: "nocloud-metadata.tmpl"
    Name: "nocloud-metadata"
    Path: "{{.Machine.Path}}/meta-data"
  - ID: "nocloud-20.04.tmpl"
    Name: "nocloud-20.04"
    Path: "{{.Machine.Path}}/user-data"
  - ID: "select-kickseed.tmpl"
    Name: "seed"
    Path: "{{.Machine.Path}}/seed"
  - ID: "net-post-install.sh.tmpl"
    Name: "net-post-install.sh"
    Path: "{{.Machine.Path}}/post-install.sh"
  - ID: "reset-workflow.tmpl"
    Name: "reset-workflow"
    Path: "{{.Machine.Path}}/reset-workflow.sh"
  - ID: "runner.tmpl"
    Name: "runner"
    Path: "{{.Machine.Path}}/runner.sh"
  - Name: grub-secure-mac
    Path: '{{.Env.PathFor "tftp" ""}}/EFI/BOOT/grub.cfg-{{.Machine.MacAddr "pxelinux"}}'
    ID: default-grub.tmpl
  - Name: grub-secure
    Path: '{{.Env.PathFor "tftp" ""}}/EFI/BOOT/grub.cfg-{{.Machine.HexAddress}}'
    ID: default-grub.tmpl
  - ID: "default-grub.tmpl"
    Name: "grub"
    Path: "grub/{{.Machine.Address}}.cfg"
  - ID: "default-grub.tmpl"
    Name: "grub-mac"
    Path: 'grub/{{.Machine.MacAddr "grub"}}.cfg'
