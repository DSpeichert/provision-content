
#
# Library to help manage common validation routines
#

add_validation_error() {
  local err="$1"
  local taskname="{{slice .Machine.Tasks .Machine.CurrentTask | first}}"

  local list=$(get_param validation/errors)

  list="$(jq ". += [\"${taskname}: ${err}\"]" <<< "$list")"

  set_param validation/errors "$list"
}

validate_machine_name_dns_by_ip() {
    local my_ip=$(getent hosts {{.Machine.Name}}|awk '{print $1}')

    if [[ ${my_ip} != $1 ]]; then
        return 1
    fi
    return 0
}
